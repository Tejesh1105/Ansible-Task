---
- name: Dbserver setup
  hosts: dbserver
  become: yes
  vars:
  dbname: onepiece
  dbuser: Goldroger
  dbpass: shanks
  tasks: 
    - name: Install mariadb-server
      ansible.builtin.yum:
        name: mariadb-server
        state: present
    
    - name: Install pymsql
      ansible.builtin.yum:
        name: python3-PyMySQL
        state: present
    
    - name: Start mariabdb-Service
      ansible.builtin.service:
        name: mariadb
        state: started
        enabled: yes   

    - name: Create a new database with name "accounts"
      community.mysql.mysql_db: 
         name: "{{dbname}}"
         state: present  
         login_unix_socket: /var/lib/mysql/mysql.sock
    
    - name: Create database user with name 'vprofile'
      community.mysql.mysql_user:
         name: "{{dbuser}}"
         password: "{{dbpass}}"
         priv: '*.*:ALL'
         state: present 

